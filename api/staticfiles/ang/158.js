"use strict";(self.webpackChunkcrypto_trader=self.webpackChunkcrypto_trader||[]).push([[158],{3158:(st,C,a)=>{a.r(C),a.d(C,{UserCryptoModule:()=>at});var i=a(8583),g=a(4402),t=a(7716),p=a(5952),d=a(1877),f=a(1731),y=a(297),c=a(4671),T=a(9976),v=a(9577),U=a(6499);function w(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"fa-icon",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleChart()}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("icon",e.faChevronLeft)}}function S(o,n){if(1&o&&t._UZ(0,"app-chart",5),2&o){const e=t.oxw();t.Q6J("chartConfig",e.chartConfig)("chartData",e.chartData)}}function N(o,n){if(1&o&&t._UZ(0,"app-chart",6),2&o){const e=t.oxw();t.Q6J("chartConfig",e.amountChartConfig)("chartData",e.amountChartData)}}function M(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"fa-icon",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleChart()}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("icon",e.faChevronRight)}}let D=(()=>{class o{constructor(e,r){this.ownedCryptoService=e,this.changeDetectorRef=r,this.showValues=!0,this.chartCreated=!1,this.faChevronRight=T._tD,this.faChevronLeft=T.A35}ngOnInit(){this.initChartConfig()}initChartConfig(){this.ownedCryptoService.getCryptos().subscribe(e=>{this.cryptos=e,this.showValues?this.createChartConfig():this.createAmountChartConfig(),this.chartCreated=e&&e.length>0,this.changeDetectorRef.detectChanges()})}createChartConfig(){this.chartConfig=(new f.P).withXAxis(new y.n("timeseries",{display:!1,text:null},{parser:y._.DaysAndMonth},!1)).withTitle("Your crypto values").withType("pie"),this.chartData=(new c.l).withLabels(this.cryptos.map(e=>e.name)).withDatasets([new c.b("Balance",this.cryptos.map(e=>Math.abs(e.value)),["green","red","blue","yellow","brown","orange","pink","black","white","gray"],["green","red","blue","yellow","brown","orange","pink","black","white","gray"],1)])}createAmountChartConfig(){this.amountChartConfig=(new f.P).withTitle("Amount of your cryptos").withoutLegend().withType("bar"),this.amountChartData=(new c.l).withLabels(this.cryptos.map(e=>e.name)).withDatasets([new c.b(null,this.cryptos.map(e=>Math.abs(e.amount)),["green","red","blue","yellow","brown","orange","pink","black","white","gray"],["green","red","blue","yellow","brown","orange","pink","black","white","gray"],1)])}toggleChart(){this.showValues=!this.showValues,this.showValues?this.createChartConfig():this.createAmountChartConfig()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.e),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-user-crypto-chart"]],decls:5,vars:4,consts:[[1,"flex","items-center","justify-content-center"],["class","text-gray-700 text-3xl",3,"icon","click",4,"ngIf"],["id","userCryptoValue","class","flex-1 pie",3,"chartConfig","chartData",4,"ngIf"],["id","userCryptoAmount","class","flex-1",3,"chartConfig","chartData",4,"ngIf"],[1,"text-gray-700","text-3xl",3,"icon","click"],["id","userCryptoValue",1,"flex-1","pie",3,"chartConfig","chartData"],["id","userCryptoAmount",1,"flex-1",3,"chartConfig","chartData"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t.YNc(1,w,1,1,"fa-icon",1),t.YNc(2,S,1,2,"app-chart",2),t.YNc(3,N,1,2,"app-chart",3),t.YNc(4,M,1,1,"fa-icon",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!r.showValues),t.xp6(1),t.Q6J("ngIf",r.chartCreated&&r.showValues),t.xp6(1),t.Q6J("ngIf",r.chartCreated&&!r.showValues),t.xp6(1),t.Q6J("ngIf",r.showValues))},directives:[i.O5,v.BN,U.x],styles:["app-user-crypto-chart .pie .chart-container{margin-left:auto;margin-right:auto;height:400px;width:400px}@media only screen and (max-width: 600px){app-user-crypto-chart .pie .chart-container{height:280px;width:280px}}\n"],encapsulation:2,changeDetection:0}),o})();var R=a(299),b=a(6701);class l{constructor(n,e,r,s){this.price=n,this.value=e,this.amount=r,this.crypto=s}static fromDomain(n){return new l(n.price,n.value,n.amount,n.name)}}class u{constructor(n,e,r,s,m){this.id=n,this.data=e,this.level=r,this.expanded=s,this.position=m}static fromDomain(n){return new u("OWNED-CRYPTO-"+Math.floor(1e4*Math.random()),l.fromDomain(n),0,!1,null)}}var x=a(686),Z=a(4294),O=a(5726),J=a(6817),A=a(9504),B=a(5146),Y=a(1250),F=a(2739),I=a(3611),h=a(8131);function Q(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"div",6),t.TgZ(2,"h2"),t._uU(3,"You will earn"),t.qZA(),t.TgZ(4,"app-text-badge",7),t._uU(5),t.ALo(6,"price"),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(5),t.hij("+",t.lcZ(6,1,e.amount*e.cryptoPrice),"$")}}let E=(()=>{class o{constructor(e){this.transactionResource=e,this.sold=new t.vpe,this.ButtonColors=x.T,this.config=[{type:Y.y.NUMBER,label:"Amount",name:"amount",placeholder:"Insert the amount you would like to sell"}]}ngOnInit(){}observeForm(e){this.form=e,this.form.valueChanges.subscribe(r=>{this.amount=r.amount})}onSellAmount(){this.sellCrypto(-this.amount)}onSellAll(){this.sellCrypto(-this.maxAmount)}sellCrypto(e){this.transactionResource.tradeCrypto(new B.I(this.crypto,e)).pipe((0,Z.q)(1)).subscribe(()=>{this.sold.emit()})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(F.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sell"]],inputs:{crypto:"crypto",cryptoPrice:"cryptoPrice",maxAmount:"maxAmount"},outputs:{sold:"sold"},decls:10,vars:6,consts:[[1,"container"],[1,"flex","justify-content-center","items-center"],[3,"config","formOutput"],[3,"color","disabled","click"],[1,"sell-all-button",3,"color","click"],[4,"ngIf"],[1,"flex","items-center"],["color","green",1,"ml-2","mt-1"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"h2"),t._uU(2),t.qZA(),t.TgZ(3,"div",1),t.TgZ(4,"app-form",2),t.NdJ("formOutput",function(m){return r.observeForm(m)}),t.qZA(),t.TgZ(5,"app-button",3),t.NdJ("click",function(){return r.onSellAmount()}),t._uU(6," Sell "),t.qZA(),t.TgZ(7,"app-button",4),t.NdJ("click",function(){return r.onSellAll()}),t._uU(8," Sell all "),t.qZA(),t.qZA(),t.YNc(9,Q,7,3,"ng-container",5),t.qZA()),2&e&&(t.xp6(2),t.hij("How many ",r.crypto,"s would you like to sell?"),t.xp6(2),t.Q6J("config",r.config),t.xp6(1),t.Q6J("color",r.ButtonColors.GREEN)("disabled",!r.amount||r.amount>r.maxAmount),t.xp6(2),t.Q6J("color",r.ButtonColors.RED),t.xp6(2),t.Q6J("ngIf",r.amount&&r.amount<r.maxAmount))},directives:[I.U,A.r,i.O5,d.N],pipes:[h.d],styles:[".container{text-align:center;width:100%}.container form{padding:0;background:transparent;box-shadow:none}.container app-button{margin-top:.5rem}.container input{width:150px}.container .sell-all-button{width:100px}\n"],encapsulation:2,changeDetection:0}),o})();function P(o,n){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=n.node;t.xp6(1),t.Oqu(e.data.crypto)}}function V(o,n){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"price"),t.qZA()),2&o){const e=n.node;t.xp6(1),t.hij("",t.lcZ(2,1,e.data.price),"$")}}function L(o,n){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=n.node;t.xp6(1),t.Oqu(e.data.amount)}}function j(o,n){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=n.node;t.xp6(1),t.hij("",e.data.value,"$")}}function X(o,n){if(1&o&&(t.TgZ(0,"app-button",5),t._uU(1,"Sell "),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("color",e.ButtonColors.GREEN)}}function H(o,n){if(1&o&&(t.TgZ(0,"div",2),t.TgZ(1,"app-tree",3),t.TgZ(2,"app-tree-column"),t.YNc(3,P,2,1,"ng-template"),t.qZA(),t.TgZ(4,"app-tree-column"),t.YNc(5,V,3,3,"ng-template"),t.qZA(),t.TgZ(6,"app-tree-column"),t.YNc(7,L,2,1,"ng-template"),t.qZA(),t.TgZ(8,"app-tree-column"),t.YNc(9,j,2,1,"ng-template"),t.qZA(),t.TgZ(10,"app-tree-column",4),t.YNc(11,X,2,1,"ng-template"),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(),r=t.MAs(4);t.xp6(1),t.Q6J("nodes",e.nodes)("columns",e.accountTreeColumns)("viewStrategy",e.viewStrategy),t.xp6(9),t.Q6J("popperContent",r)}}function $(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"app-sell",6),t.NdJ("sold",function(){return t.CHM(e),t.oxw().onSold()}),t.qZA()}if(2&o){const e=n.data;t.Q6J("crypto",e.crypto)("maxAmount",e.amount)("cryptoPrice",e.price)}}let q=(()=>{class o{constructor(e,r){this.ownedCryptoService=e,this.changeDetectorRef=r,this.NUMBER_OF_COLUMNS=5,this.initTree=!1,this.showPopper=!1,this.ButtonColors=x.T,this.accountTreeColumns=(new R.x.Builder).withHeaders(["Crypto","Price","Amount","Value"]).withFlex(["0 1 20%","0 1 20%","0 1 20%","0 1 20%","0 1 20%"]).build(this.NUMBER_OF_COLUMNS),this.viewStrategy=b.g.TEMPLATE}ngOnInit(){this.createNodes()}onSold(){this.ownedCryptoService.fetchOwnedCrypto().pipe((0,Z.q)(1)).subscribe()}toNodes(e){this.nodes=e.map(r=>u.fromDomain(r))}createNodes(){this.ownedCryptoService.getCryptos().subscribe(e=>{this.ownedCrypto=e,e&&this.toNodes(e),this.initTree=e&&e.length>0,this.changeDetectorRef.detectChanges()})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.e),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-user-crypto-tree"]],decls:5,vars:1,consts:[["class","text-sm",4,"ngIf"],["popperContent",""],[1,"text-sm"],[3,"nodes","columns","viewStrategy"],[3,"popperContent"],[1,"sell-button",3,"color"],[3,"crypto","maxAmount","cryptoPrice","sold"]],template:function(e,r){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Your cryptos:"),t.qZA(),t.YNc(2,H,12,4,"div",0),t.YNc(3,$,1,3,"ng-template",null,1,t.W1O)),2&e&&(t.xp6(2),t.Q6J("ngIf",r.initTree))},directives:[i.O5,O.q,J.F,A.r,E],pipes:[h.d],styles:["app-user-crypto-tree .sell-button button{padding-top:.25rem;padding-bottom:.25rem}app-user-crypto-tree div.ngxp__container{max-width:500px}\n"],encapsulation:2,changeDetection:0}),o})();const z=[{path:"",component:(()=>{class o{constructor(e){this.ownedCryptoService=e}ngOnInit(){this.ownedCryptoService.fetchOwnedCrypto().subscribe(),this.balance$=this.ownedCryptoService.getBalance()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.e))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-user-crypto-root"]],decls:12,vars:5,consts:[[1,"bg-white","text-sm","rounded-b","p-4"],[1,"flex","items-center"],[1,"mr-1"],["color","green",1,"text-lg"],[1,"ml-1"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h2",2),t._uU(3,"You have currently "),t.qZA(),t.TgZ(4,"app-text-badge",3),t._uU(5),t.ALo(6,"price"),t.ALo(7,"async"),t.qZA(),t.TgZ(8,"h2",4),t._uU(9,"allocated in cryptos."),t.qZA(),t.qZA(),t._UZ(10,"app-user-crypto-chart"),t._UZ(11,"app-user-crypto-tree"),t.qZA()),2&e&&(t.xp6(5),t.hij("",t.lcZ(6,1,t.lcZ(7,3,r.balance$)),"$"))},directives:[d.N,D,q],pipes:[h.d,i.Ov],styles:[""],encapsulation:2,changeDetection:0}),o})()}];let G=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.Bz.forChild(z)],g.Bz]}),o})();var W=a(5640),K=a(4657),_=a(7406),k=a(8527),tt=a(1641),et=a(9940),ot=a(2544),nt=a(2558),rt=a(4159);let at=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[v.uH,G,i.ez,W.AccountRootModule,K.S,_.x,k.N,tt.F,et.h,ot.X_,nt.e,rt.e]]}),o})()}}]);