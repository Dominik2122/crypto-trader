"use strict";(self.webpackChunkcrypto_trader=self.webpackChunkcrypto_trader||[]).push([[326],{1326:(Dt,y,c)=>{c.r(y),c.d(y,{AccountModule:()=>vt});var l=c(8583),S=c(4657),R=c(4159),p=c(5138),u=c(5207),M=c(3766),E=c(5894),O=c(1964),r=c(6710);const f=(0,r.PH)("[AccountData] Fetch AccountData",(0,r.Ky)()),v=(0,r.PH)("[AccountData] Fetch AccountData Success",(0,r.Ky)()),D=(0,r.PH)("[AccountData] Fetch AccountData Failure",(0,r.Ky)());var t=c(7716),Y=c(2809),U=c(1841),w=c(4211);let C=(()=>{class n extends Y.i{fetchData(e){const o=(new U.LE).append("days",e?`${e}`:"14");return this.get("api/account/account-info",o).pipe((0,u.U)(s=>w.m.fromDTO(s)))}signUp(e){return this.post("api/user/create/",e)}}return n.\u0275fac=function(){let a;return function(o){return(a||(a=t.n5z(n)))(o||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),B=(()=>{class n{constructor(e,o){this.actions$=e,this.accountResource=o,this.loadAccountDatas$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(f),(0,u.U)(s=>s.days),(0,M.b)(s=>this.accountResource.fetchData(s).pipe((0,u.U)(i=>v({data:i})),(0,E.K)(i=>(0,O.of)(D({error:i})))))))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(p.eX),t.LFG(C))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const T="accountData",H=(0,r.Lq)({balance:0,transactions:null,pastData:null},(0,r.on)(f,n=>n),(0,r.on)(D,(n,a)=>n),(0,r.on)(v,(n,a)=>Object.assign({},n,a.data))),m=(0,r.ZF)(T),L=(0,r.P1)(m,n=>n.balance),I=(0,r.P1)(m,n=>n.transactions),J=(0,r.P1)(m,n=>n.pastData);let P=(()=>{class n{constructor(e){this.store=e}fetchAccountData(e){return this.store.dispatch(f({days:e}))}selectAccountBalance(){return this.store.select(L)}selectAccountTransactions(){return this.store.select(I)}selectAccountPastData(){return this.store.select(J)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(r.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),h=(()=>{class n{constructor(e){this.accountDataRepository=e}fetchAccountData(e){return this.accountDataRepository.fetchAccountData(e)}selectAccountBalance(){return this.accountDataRepository.selectAccountBalance()}selectAccountPastData(){return this.accountDataRepository.selectAccountPastData()}selectAccountTransactions(){return this.accountDataRepository.selectAccountTransactions()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(P))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var G=c(7406),z=c(1641),j=c(8527),Q=c(5094),X=c(1598),x=c(9922);let Z=(()=>{class n{constructor(e){this.accountDataService=e,this.NODES_PER_PAGE=10,this.paginationPage=0,this.paginationPage$=new Q.X(0),this.getNodes()}transactionsToShow(){return(0,X.a)([this.transactions$.pipe((0,x.b)(e=>this.transactionsNumber=e&&e.length),(0,x.b)(()=>this.paginationPage$.next(this.paginationPage))),this.paginationPage$.asObservable()]).pipe((0,u.U)(([e,o])=>e&&e.filter((s,i)=>o*this.NODES_PER_PAGE<=i&&o*this.NODES_PER_PAGE+this.NODES_PER_PAGE>i)))}clickPaginationPage(e){this.paginationPage=e,this.paginationPage$.next(e)}currentPaginationPages(){return this.paginationPage$.asObservable().pipe((0,u.U)(e=>{if(this.transactionsNumber<10)return[];if(e<2)return Math.floor(this.transactionsNumber/10+1)<5?[...Array(this.transactionsNumber/10).keys()]:[...Array(5).keys()];if(e>this.transactionsNumber/10-2){const o=[];for(let s=Math.floor(this.transactionsNumber/10+1)-5;s<Math.floor(this.transactionsNumber/10+1);s++)o.push(s);return o}{const o=[];for(let s=e-2;s<=e+2;s++)o.push(s);return o}}))}getNodes(){this.transactions$=this.accountDataService.selectAccountTransactions(),this.transactions$.subscribe(e=>{this.transactions=e,this.transactionsNumber=e&&e.length})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(h))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var F=c(4402),W=c(1250),g=(()=>{return(n=g||(g={}))[n.Yesterday=1]="Yesterday",n[n.Week=7]="Week",n[n["2 weeks"]=14]="2 weeks",n[n.Month=30]="Month",g;var n})(),K=c(3611);let V=(()=>{class n{constructor(){this.days=new t.vpe,this.options=[{value:1,legend:"Yesterday"},{value:2,legend:"Week"},{value:3,legend:"2 weeks"},{value:4,legend:"Month"}],this.formConfig=[{type:W.y.RANGE,label:"Select date range",name:"range",showTicks:!0,stepsArray:this.options}]}ngOnInit(){}observeForm(e){this.form=e,this.form.valueChanges.subscribe(o=>{const s=this.options.find(i=>i.value===o.range);this.days.next(g[s.legend]),this.range=o.range})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-account-date-range-form"]],outputs:{days:"days"},decls:1,vars:1,consts:[[3,"config","formOutput"]],template:function(e,o){1&e&&(t.TgZ(0,"app-form",0),t.NdJ("formOutput",function(i){return o.observeForm(i)}),t.qZA()),2&e&&t.Q6J("config",o.formConfig)},directives:[K.U],styles:["ngx-slider::ng-deep .ngx-slider .ngx-slider-tick-legend{white-space:unset}app-account-date-range-form form.shadow-lg{box-shadow:unset}app-account-date-range-form app-select-field label{text-align:center;padding:0}app-account-date-range-form .ngx-slider-inner-tooltip{display:none;height:0}\n"],encapsulation:2,changeDetection:0}),n})();var k=c(1731),b=c(297),N=c(4671),q=c(6499);function _(n,a){if(1&n&&(t.TgZ(0,"div",2),t.TgZ(1,"h2",3),t._uU(2,"Your account balance"),t.qZA(),t._UZ(3,"app-chart",4),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("chartConfig",e.chartConfig)("chartData",e.chartData)}}function tt(n,a){1&n&&(t.TgZ(0,"h2",3),t._uU(1,"Not enough data to create chart. Buy or sell!"),t.qZA())}let et=(()=>{class n{constructor(){this.isLoaded=!1}ngOnChanges(e){e.balanceHistory&&this.balanceHistory&&(!this.balanceHistory||this.balanceHistory.length<2?this.isLoaded=!1:(this.isLoaded=!0,this.createChartConfig()))}ngOnInit(){}createChartConfig(){this.chartConfig=(new k.P).withXAxis(new b.n("time",{display:!1,text:null},{parser:b._.DaysAndMonth})).withType("line"),this.chartData=(new N.l).withLabels(this.balanceHistory.map(e=>e.date)).withDatasets([new N.b("Balance",this.balanceHistory.map(e=>e.balance),"green","black",1)])}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-account-chart"]],inputs:{balanceHistory:"balanceHistory"},features:[t.TTD],decls:3,vars:2,consts:[["class","",4,"ngIf","ngIfElse"],["notEnough",""],[1,""],[1,"my-2"],["id","headerAccount",3,"chartConfig","chartData"]],template:function(e,o){if(1&e&&(t.YNc(0,_,4,2,"div",0),t.YNc(1,tt,2,0,"ng-template",null,1,t.W1O)),2&e){const s=t.MAs(2);t.Q6J("ngIf",o.isLoaded)("ngIfElse",s)}},directives:[l.O5,q.x],styles:[""],encapsulation:2,changeDetection:0}),n})();var nt=c(299),at=c(6701);class A{constructor(a,e,o,s,i){this.date=a,this.price=e,this.value=o,this.amount=s,this.crypto=i}static fromDomain(a){return new A(`${a.date.getDate()}/${a.date.getMonth()+1}/${a.date.getFullYear()-2e3}`,a.price,a.value,a.amount,a.crypto)}}class d{constructor(a,e,o,s,i){this.id=a,this.data=e,this.level=o,this.expanded=s,this.position=i}static fromDomain(a){return new d("HOME-"+a.id,A.fromDomain(a),0,!1,null)}static fromArrayDomain(a){return a.map((e,o)=>d.fromDomain(e).withPosition(o))}withPosition(a){return this.position=a,this}}var ot=c(5726),ct=c(6817),st=c(1877),it=c(8131);function rt(n,a){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const e=a.node;t.xp6(1),t.Oqu(e.data.date)}}function ut(n,a){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const e=a.node;t.xp6(1),t.Oqu(e.data.crypto)}}function lt(n,a){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"price"),t.qZA()),2&n){const e=a.node;t.xp6(1),t.hij("",t.lcZ(2,1,e.data.price),"$")}}function pt(n,a){if(1&n&&(t.TgZ(0,"app-text-badge",7),t._uU(1),t.qZA()),2&n){const e=a.node;t.Q6J("color",e.data.amount<0?"green":"red"),t.xp6(1),t.hij(" ",e.data.amount," ")}}function ht(n,a){1&n&&t._uU(0),2&n&&t.hij(" ",a.node.data.value,"$ ")}function gt(n,a){if(1&n&&(t.TgZ(0,"div",5),t.TgZ(1,"app-tree",6),t.TgZ(2,"app-tree-column"),t.YNc(3,rt,2,1,"ng-template"),t.qZA(),t.TgZ(4,"app-tree-column"),t.YNc(5,ut,2,1,"ng-template"),t.qZA(),t.TgZ(6,"app-tree-column"),t.YNc(7,lt,3,3,"ng-template"),t.qZA(),t.TgZ(8,"app-tree-column"),t.YNc(9,pt,2,2,"ng-template"),t.qZA(),t.TgZ(10,"app-tree-column"),t.YNc(11,ht,1,1,"ng-template"),t.qZA(),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("nodes",e.nodes)("columns",e.accountTreeColumns)("viewStrategy",e.viewStrategy)}}function dt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"li"),t.TgZ(1,"a",8),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.oxw().clickPage(i)}),t._uU(2),t.qZA(),t.qZA()}if(2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.ekj("active",e===o.currentPaginationPage),t.xp6(1),t.Oqu(e+1)}}function ft(n,a){1&n&&(t.TgZ(0,"div",9),t.TgZ(1,"h4"),t._uU(2,"No transactions in this period of time!"),t.qZA(),t.qZA())}let mt=(()=>{class n{constructor(e,o,s){this.accountDataService=e,this.accountPaginationService=o,this.changeDetectorRef=s,this.NUMBER_OF_COLUMNS=5,this.initTree=!1,this.currentPaginationPage=0,this.accountTreeColumns=(new nt.x.Builder).withHeaders(["Date","Crypto","Price","Amount","Value"]).withFlex(["0 1 17%","0 1 28%","0 1 20%","0 1 15%","0 1 20%"]).build(this.NUMBER_OF_COLUMNS),this.viewStrategy=at.g.TEMPLATE}ngOnInit(){this.createNodes(),this.createPaginationTable()}clickPage(e){this.currentPaginationPage=e,this.accountPaginationService.clickPaginationPage(e),this.changeDetectorRef.detectChanges()}toNodes(e){this.nodes=d.fromArrayDomain(e)}createNodes(){this.accountPaginationService.transactionsToShow().subscribe(e=>{this.transactions=e,e&&this.toNodes(e),this.initTree=e&&e.length>0,this.changeDetectorRef.detectChanges()})}createPaginationTable(){this.accountPaginationService.currentPaginationPages().subscribe(e=>{this.currentPaginationPages=e,this.changeDetectorRef.detectChanges()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h),t.Y36(Z),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-account-tree"]],decls:8,vars:3,consts:[["class","text-sm",4,"ngIf","ngIfElse"],[1,"mx-auto","flex","justify-content-center"],[1,"pagination","modal-3","mx-auto"],[4,"ngFor","ngForOf"],["noData",""],[1,"text-sm"],[3,"nodes","columns","viewStrategy"],["subtle","true",3,"color"],[3,"click"],[1,"no-data"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h2"),t._uU(1,"Your recent transactions:"),t.qZA(),t.YNc(2,gt,12,3,"div",0),t.TgZ(3,"div",1),t.TgZ(4,"ul",2),t.YNc(5,dt,3,3,"li",3),t.qZA(),t.qZA(),t.YNc(6,ft,3,0,"ng-template",null,4,t.W1O)),2&e){const s=t.MAs(7);t.xp6(2),t.Q6J("ngIf",o.initTree&&0!==o.transactions.length)("ngIfElse",s),t.xp6(3),t.Q6J("ngForOf",o.currentPaginationPages)}},directives:[l.O5,l.sg,ot.q,ct.F,st.N],pipes:[it.d],styles:[".pagination{list-style:none;display:inline-block;padding:0;margin-top:10px}.pagination li{display:inline;text-align:center}.pagination a{float:left;display:block;font-size:14px;text-decoration:none;padding:5px 12px;border:1px solid black;line-height:1.5;margin:0 .5rem}.pagination a:active{outline:none}.modal-3 a{margin-left:3px;padding:0;width:30px;height:30px;line-height:30px;border-radius:100%}.modal-3 a:hover{--tw-bg-opacity: 1;background-color:rgba(248,113,113,var(--tw-bg-opacity))}.modal-3 a.active,.modal-3 a:active{--tw-bg-opacity: 1;background-color:rgba(37,99,235,var(--tw-bg-opacity))}\n"],encapsulation:2,changeDetection:0}),n})();const At=[{path:"",component:(()=>{class n{constructor(e,o){this.accountDataService=e,this.changeDetectorRef=o,this.days=1}ngOnInit(){this.accountDataService.fetchAccountData(this.days),this.accountDataService.selectAccountPastData().subscribe(e=>{this.balanceHistory=e,this.changeDetectorRef.detectChanges()})}onDaysChanges(e){this.days=e,this.accountDataService.fetchAccountData(this.days),this.changeDetectorRef.detectChanges()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-account"]],decls:4,vars:1,consts:[[1,"bg-white","text-sm","rounded-b","p-4"],[3,"days"],[3,"balanceHistory"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"app-account-date-range-form",1),t.NdJ("days",function(i){return o.onDaysChanges(i)}),t.qZA(),t._UZ(2,"app-account-chart",2),t._UZ(3,"app-account-tree"),t.qZA()),2&e&&(t.xp6(2),t.Q6J("balanceHistory",o.balanceHistory))},directives:[V,et,mt],styles:[""],encapsulation:2,changeDetection:0}),n})()}];let yt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[F.Bz.forChild(At)],F.Bz]}),n})(),vt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[h,P,C,Z],imports:[[yt,l.ez,S.S,R.e,r.Aw.forFeature(T,H),p.sQ.forFeature([B]),G.x,z.F,j.N]]}),n})()}}]);